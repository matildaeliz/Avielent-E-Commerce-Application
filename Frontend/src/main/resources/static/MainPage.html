<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Avielent E-Commerce | Main Page</title>
    <link rel="stylesheet" type="text/css" href="MainPage.css">
</head>
<body>
<img id="usericon" src="UserIcon.png">
<img id="logo" src="LOGO.png">
<button type="button" id = "SearchButton"> Search</button>
<button type="button" id="GUMP">User Management</button>
<button type="button" id="SellProduct">Sell Product</button>
<div>
    <label id ="balancetext"> Balance:  </label>
    <label id ="usernametext"> Username:  </label>
</div>
<input id="SearchInput"  placeholder="Text Here!" >
<button type="button" id="SearchButtonText"> Search</button>
<div id="output"></div>
</body>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById("SearchInput").style.display = "none"
        document.getElementById("SearchButtonText").style.display="none"


        var balance = new XMLHttpRequest();
        balance.open("GET", "http://localhost:9000/user/getBalance")
        balance.onreadystatechange = function () {

            if (balance.status === 200) {
                var responseText = balance.responseText;
                document.getElementById("balancetext").textContent = "Balance: " +responseText;

            }
        };
        balance.send()

        var username = new XMLHttpRequest();
        username.open("GET", "http://localhost:9000/user/getUsername")
        username.onreadystatechange = function () {

            if (username.status === 200) {
                var responseText = username.responseText;
                document.getElementById("usernametext").textContent = "Username: " +responseText;

            }
        };
        username.send()

    });
</script>

<script>
    function changeHidden() {
        var content = document.getElementById("SearchInput");
        var content2 = document.getElementById("SearchButtonText");
        if (content.style.display === 'none' ) {
            content.style.display = 'block';
            content2.style.display="block";
        } else {
            content.style.display = 'none';
            content2.style.display="none";
        }
    }
    document.getElementById("SearchButton").addEventListener("click",changeHidden)
</script>
<script>
    function GoUserManagementPage (){
        window.location.href="UserManagementPage.html"
    }
    document.getElementById("GUMP").addEventListener("click",GoUserManagementPage)

    function GoSellProductPage(){
        window.location.href="SellProductPage.html"
    }

    document.getElementById("SellProduct").addEventListener("click",GoSellProductPage)
</script>



<script>
function search(){
    var xhr = new XMLHttpRequest();
    xhr.open("GET", "http://localhost:9000/product/getProducts?productname="+ document.getElementById("SearchInput").value, true);

    xhr.onreadystatechange = function () {
        if (xhr.readyState == 4 && xhr.status == 200) {
            var productList = JSON.parse(xhr.responseText);
            var outputDiv = document.getElementById('output');

            productList.forEach(function(product) {
                var productInfo = document.createElement('p');
                productInfo.textContent = 'Name: ' + product.product_name + ', Price: ' + product.product_price;
                outputDiv.appendChild(productInfo);

            });
        } else if (xhr.readyState == 4 && xhr.status != 200) {
            console.error('Hata olu≈ütu. Durum Kodu:', xhr.status);
        }
    };

    xhr.send();
}


    document.getElementById("SearchButtonText").addEventListener("click",search)
</script>


</html>